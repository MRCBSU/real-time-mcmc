#!/bin/bash

#SBATCH --nodes=1
#! How many (MPI) tasks will there be in total? (<= nodes*16)
#SBATCH --ntasks=1
#! How many CPUs will each task require
#SBATCH --cpus-per-task=2
#! How much wallclock time will be required?
#SBATCH --time=0:30:00
#! What types of email messages do you wish to receive?
#SBATCH --mail-type=FAIL,TIME_LIMIT,END
#SBATCH --mail-user=joel.kandiah@phe.gov.uk
#! Uncomment this to prevent the job from being requeued (e.g. if
#! interrupted by node failure or system downtime):
#SBATCH --no-requeue
#SBATCH --verbose
#SBATCH --array=0-15
#SBATCH --output=submit_save_endstates_%a_%j.out
#SBATCH --error=submit_save_endstates_%a_%j.err
#SBATCH --partition=standard-wp
#SBATCH --mem=50G

<<<<<<< HEAD
module load R gcc/gcc-9.4.0 openmp intel_compiler OpenBLAS openmpi slurm
=======
#SBATCH --array=0-11
#SBATCH -p icelake
#SBATCH --qos=covid0


#SBATCH --output=model_runs_20210120regjobs_%a.out
#SBATCH --error=model_runs_20210120regjobs_%a.err

module purge
module load rhel8/default-icl
>>>>>>> d57401911579f16086976ff69cbcc365b7cbd93d

dirs=(*/)
pwd
application="Rscript"
options="~/mcmc/real-time-mcmc/R/output/save_end_state.R"
CMD="$application $options ${dirs[SLURM_ARRAY_TASK_ID]}"
# echo "${dirs[SLURM_ARRAY_TASK_ID]}/posterior_report10"
# if [ -e "${dirs[SLURM_ARRAY_TASK_ID]}/posterior_report10" ]; then
#     echo "Running $CMD"
  eval $CMD
  # sbatch 
# fi
